server:
  # === SỬA LỖI PORT ===
  # Dòng này sẽ sử dụng cổng (port) mà Render cung cấp.
  # Nếu không có (chạy local), nó sẽ dùng cổng 8080.
  port: ${PORT:8080}
  servlet:
    context-path: /isp392
  forward-headers-strategy: framework

spring:
  datasource:
    # === SỬA LỖI BẢO MẬT ===
    # Sử dụng biến môi trường cho tất cả thông tin nhạy cảm
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: com.microsoft.sqlserver.jdbc.SQLServerDriver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    database-platform: org.hibernate.dialect.SQLServerDialect
  mail:
    host: smtp.gmail.com
    port: 587
    username: moncuaban@gmail.com
    # === SỬA LỖI BẢO MẬT ===
    password: ${MAIL_PASSWORD} # Không bao giờ hard-code mật khẩu
    protocol: smtp
    default-encoding: UTF-8
    properties:
      mail.smtp.auth: true
      mail.smtp.starttls.enable: true

  security:
    oauth2:
      client:
        registration:
          google:
            # === SỬA LỖI BẢO MẬT ===
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"
            scope:
              - email
              - profile
        provider:
          google:
            issuer-uri: https://accounts.google.com

app:
  frontend:
    reset-password-url: ${FRONTEND_RESET_PASSWORD_URL:http://localhost:5173/reset-password}
    verify-email-url: ${FRONTEND_VERIFY_EMAIL_URL:http://localhost:5173/verify-email}
    google-callback-url: ${FRONTEND_GOOGLE_CALLBACK_URL:https://moncuaban.vercel.app/auth/callback}

jwt:
  # === SỬA LỖI BẢO MẬT ===
  signerKey: ${JWT_SIGNER_KEY}

cloudinary:
  # === SỬA LỖI BẢO MẬT ===
  cloud-name: ${CLOUDINARY_CLOUD_NAME}
  api-key: ${CLOUDINARY_API_KEY}
  api-secret: ${CLOUDINARY_API_SECRET}

payos:
  # === SỬA LỖI BẢO MẬT ===
  client-id: ${PAYOS_CLIENT_ID}
  api-key: ${PAYOS_API_KEY}
  checksum-key: ${PAYOS_CHECKSUM_KEY}
  return-url: ${PAYOS_RETURN_URL:http://localhost:5173/payment/success}
  cancel-url: ${PAYOS_CANCEL_URL:http://localhost:5173/payment/cancel}
  webhook-key: ${PAYOS_WEBHOOK_KEY}

logging:
  file:
    name: /app/logs/app.log
  level:
    root: INFO
    com.isp392: DEBUG

# Khối 'google' này đã ở đúng định dạng
google:
  gemini:
    project-id: "${GOOGLE_GEMINI_PROJECT_ID}"
    location: "${GOOGLE_GEMINI_LOCATION}"
    model-name: "${GOOGLE_GEMINI_MODEL_NAME}"